# JMM

Java内存模型 并不真实存在 只是一种规范 通过这组规范定义了程序中各个变量（包括实例字段 静态字段和构成数组对象的元素）的访问方式

***

JMM关于同步的规定

1. 线程解锁前 必须把共享变量的值刷回主内存
2. 线程加锁前 必须读取主内存的最新值到自己的工作内存
3. 加锁解锁是同一把锁

***

<img src="http://img.tomato530.com/JMM.png" style="zoom:50%;" />

由于JVM运行程序的实体是线程 而每个线程创建时JVM都会为其创建一个工作内存 工作内存是每个线程的私有区域 而JMM规定所有共享变量都存在主内存（Java堆）中 主内存是共享内存区域 所有线程都可以访问 **但是线程堆变量的操作（读取赋值等）必须在工作内存中进行 首先要将变量从主内存拷贝到自己的工作内存空间 然后对变量进行操作 操作完成后再将变量写回主内存** 不能直接操作主内存中的变量 每个线程中的工作内存存储着主内存中的变量拷贝副本 因此不同的线程间无法访问对方的工作内存 线程间的通信（传值）必须通过主内存来完成

